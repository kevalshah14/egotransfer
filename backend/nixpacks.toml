# Nixpacks configuration for Railway
# See: https://nixpacks.com/docs/configuration/file
# Updated: 2025-11-17 - OpenGL dependencies fix

[phases.setup]
# System dependencies for OpenCV/MediaPipe in headless environment (Ubuntu 24.04 compatible)
aptPkgs = [
    "libgl1",               # OpenGL library (provides libGL.so.1)
    "libglx0",              # GLX library
    "libglib2.0-0",         # GLib library
    "libsm6",               # X11 Session Management library
    "libxext6",             # X11 extensions library
    "libxrender1",          # X Rendering Extension library
    "libgomp1",             # GCC OpenMP library
    "libgthread-2.0-0",     # GLib thread library
    "libice6",              # X11 Inter-Client Exchange library
    "libx11-6",             # X11 client library
    "libfontconfig1",       # Font configuration library
    "libxcb1",              # X protocol C-language Binding
    "ffmpeg"                # Video codec support
]

# Let Nixpacks auto-detect Python and handle pip installation
# Nixpacks will automatically install requirements.txt

[start]
cmd = "uvicorn main:app --host 0.0.0.0 --port $PORT"

