# Nixpacks configuration for Railway
# See: https://nixpacks.com/docs/configuration/file

[phases.setup]
nixPkgs = ["python312"]
# System dependencies for OpenCV/MediaPipe in headless environment
aptPkgs = [
    "libgl1-mesa-glx",      # OpenGL library (provides libGL.so.1)
    "libglib2.0-0",         # GLib library
    "libsm6",               # X11 Session Management library
    "libxext6",             # X11 extensions library
    "libxrender1",          # X Rendering Extension library
    "libgomp1",             # GCC OpenMP library
    "libgthread-2.0-0",     # GLib thread library
    "libice6",              # X11 Inter-Client Exchange library
    "libx11-6",             # X11 client library
    "ffmpeg",               # Video codec support
    "libavcodec-extra"      # Additional codec support
]

[phases.install]
cmds = ["pip install -r requirements.txt"]

[start]
cmd = "uvicorn main:app --host 0.0.0.0 --port $PORT"

